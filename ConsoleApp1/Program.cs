using System;
using System.IO;
using System.Linq;
using Newtonsoft.Json;
using COGSLib;
using System.Collections.Generic;

namespace ConsoleApp1
{
    class Program
    {
        static void Main(string[] args)
        {
            string buyText = @"10/6/57 11:05	20บ.	18,400.00	368,000.00
2/23/58 13:23	5บ.	18,450.00	92,250.00
2/23/58 13:25	5บ.	18,500.00	92,500.00
2/24/58 7:25	5บ.	18,400.00	92,000.00
2/24/58 22:07	5บ.	18,440.00	92,200.00
3/6/58 8:03	5บ.	18,400.00	92,000.00
3/6/58 8:03	5บ.	18,370.00	91,850.00
3/6/58 8:04	10บ.	18,350.00	183,500.00
3/6/58 8:05	10บ.	18,300.00	183,000.00
3/6/58 8:05	10บ.	18,250.00	182,500.00
3/6/58 8:06	10บ.	18,200.00	182,000.00
3/9/58 8:40	5บ.	18,110.00	90,550.00
3/9/58 8:40	10บ.	18,050.00	180,500.00
3/9/58 9:24	5บ.	18,080.00	90,400.00
3/9/58 13:09	5บ.	18,080.00	90,400.00
3/9/58 20:17	5บ.	18,080.00	90,400.00
3/10/58 8:12	10บ.	18,000.00	180,000.00
3/10/58 8:28	10บ.	17,950.00	179,500.00
3/10/58 9:38	10บ.	18,020.00	180,200.00
3/10/58 13:12	10บ.	17,970.00	179,700.00
3/11/58 8:00	10บ.	17,920.00	179,200.00
3/11/58 13:09	10บ.	17,950.00	179,500.00
3/11/58 21:12	10บ.	17,970.00	179,700.00
3/11/58 21:28	10บ.	17,950.00	179,500.00
3/12/58 8:17	10บ.	17,900.00	179,000.00
3/12/58 22:58	10บ.	17,900.00	179,000.00
7/21/58 23:53	10บ.	18,070.00	180,700.00
7/22/58 9:06	30บ.	17,950.00	538,500.00
7/22/58 9:12	20บ.	17,980.00	359,600.00
7/22/58 9:13	10บ.	17,900.00	179,000.00
7/22/58 18:53	20บ.	17,900.00	358,000.00
11/27/58 9:14	10บ.	18,100.00	181,000.00
11/27/58 9:15	50บ.	18,000.00	900,000.00
11/27/58 17:58	10บ.	18,120.00	181,200.00
12/2/58 20:13	10บ.	17,970.00	179,700.00
12/2/58 23:30	10บ.	17,970.00	179,700.00
12/3/58 7:55	20บ.	17,850.00	357,000.00
12/17/58 21:55	10บ.	17,990.00	179,900.00
11/11/59 22:21	5บ.	20,600.00	103,000.00
11/14/59 9:44	5บ.	20,490.00	102,450.00
11/14/59 9:51	5บ.	20,400.00	102,000.00
11/14/59 16:27	10บ.	20,400.00	204,000.00
11/18/59 9:12	10บ.	20,380.00	203,800.00
11/18/59 9:13	10บ.	20,350.00	203,500.00
11/18/59 23:25	10บ.	20,340.00	203,400.00
11/22/59 8:45	10บ.	20,350.00	203,500.00
11/22/59 21:05	10บ.	20,390.00	203,900.00
11/23/59 8:46	10บ.	20,250.00	202,500.00
11/23/59 8:46	10บ.	20,200.00	202,000.00
11/23/59 9:41	10บ.	20,300.00	203,000.00
11/23/59 20:41	10บ.	20,100.00	201,000.00
11/23/59 21:34	10บ.	20,150.00	201,500.00
11/25/59 8:52	10บ.	19,900.00	199,000.00
11/30/59 6:42	10บ.	19,900.00	199,000.00
11/30/59 6:43	10บ.	19,850.00	198,500.00
12/1/59 8:42	10บ.	19,780.00	197,800.00
12/1/59 8:42	10บ.	19,750.00	197,500.00
12/1/59 8:42	10บ.	19,700.00	197,000.00
12/1/59 8:43	10บ.	19,650.00	196,500.00
12/5/59 8:39	10บ.	19,650.00	196,500.00
12/5/59 8:41	10บ.	19,600.00	196,000.00
12/12/59 8:02	10บ.	19,500.00	195,000.00
12/15/59 6:16	10บ.	19,250.00	192,500.00
12/15/59 6:21	10บ.	19,200.00	192,000.00
12/15/59 7:43	10บ.	19,100.00	191,000.00
12/15/59 22:44	10บ.	19,130.00	191,300.00
6/26/60 20:08	10บ.	20,020.00	200,200.00
6/29/60 19:30	10บ.	20,000.00	200,000.00
6/30/60 12:22	10บ.	19,980.00	199,800.00
6/30/60 12:23	10บ.	19,990.00	199,900.00
7/3/60 7:16	10บ.	19,900.00	199,000.00
7/3/60 7:17	10บ.	19,850.00	198,500.00
7/3/60 7:17	10บ.	19,800.00	198,000.00
7/3/60 13:11	5บ.	19,920.00	99,600.00
7/3/60 17:12	15บ.	19,910.00	298,650.00
7/3/60 23:45	10บ.	19,710.00	197,100.00
7/5/60 15:32	10บ.	19,670.00	196,700.00
7/7/60 20:59	10บ.	19,600.00	196,000.00
12/8/60 13:41	10บ.	19,300.00	193,000.00";
            string sellText = @"8/24/58 19:30	10บ.	19,660.00	196,600.00
9/24/58 20:42	10บ.	19,700.00	197,000.00
10/14/58 6:39	10บ.	19,750.00	197,500.00
2/8/59 10:02	10บ.	19,650.00	196,500.00
2/8/59 10:03	10บ.	19,700.00	197,000.00
2/8/59 10:04	20บ.	19,750.00	395,000.00
2/8/59 22:29	30บ.	20,000.00	600,000.00
2/8/59 22:47	20บ.	19,970.00	399,400.00
2/11/59 9:35	20บ.	20,100.00	402,000.00
2/11/59 9:38	10บ.	20,150.00	201,500.00
2/11/59 15:56	20บ.	20,300.00	406,000.00
2/11/59 18:19	20บ.	20,500.00	410,000.00
2/11/59 20:27	20บ.	20,700.00	414,000.00
2/24/59 8:58	5บ.	20,750.00	103,750.00
2/24/59 9:00	5บ.	20,800.00	104,000.00
2/24/59 9:00	5บ.	20,880.00	104,400.00
2/24/59 9:01	5บ.	20,900.00	104,500.00
2/24/59 17:44	5บ.	21,000.00	105,000.00
3/8/59 9:18	5บ.	21,300.00	106,500.00
5/2/59 13:18	5บ.	21,400.00	107,000.00
6/16/59 10:29	5บ.	21,600.00	108,000.00
6/16/59 13:21	5บ.	21,700.00	108,500.00
6/16/59 13:25	5บ.	21,900.00	109,500.00
7/4/59 10:42	5บ.	22,350.00	111,750.00
4/11/60 21:27	10บ.	20,730.00	207,300.00
8/29/60 9:49	5บ.	20,650.00	103,250.00
8/29/60 9:50	5บ.	20,700.00	103,500.00
9/1/60 7:38	5บ.	20,750.00	103,750.00
9/4/60 8:11	5บ.	20,900.00	104,500.00
9/4/60 8:43	5บ.	20,870.00	104,350.00
9/6/60 9:00	5บ.	20,950.00	104,750.00
9/7/60 8:59	5บ.	21,000.00	105,000.00
9/8/60 9:07	5บ.	21,050.00	105,250.00
9/8/60 9:08	5บ.	21,100.00	105,500.00
9/8/60 9:08	5บ.	21,150.00	105,750.00
6/7/62 19:42	5บ.	19,880.00	99,400.00
6/14/62 11:47	5บ.	19,950.00	99,750.00
6/21/62 0:23	10บ.	20,250.00	202,500.00
6/25/62 0:49	10บ.	20,450.00	204,500.00
6/25/62 8:49	10บ.	20,650.00	206,500.00
6/25/62 8:49	10บ.	20,750.00	207,500.00
7/19/62 1:23	20บ.	20,850.00	417,000.00";

            var entriesBuy = GetEntries(buyText, EntryType.Buy);
            var entriesSell = GetEntries(sellText, EntryType.Sell);
            var temp = new List<Entry>();
            temp.AddRange(entriesBuy);
            temp.AddRange(entriesSell);

            var entries = new List<Entry>();
            int counter = 0;
            foreach (var e in temp.OrderBy(x => x.EntryDateTime))
                entries.Add(new Entry(++counter, e.EntryDateTime, e.EntryType, e.Quantity, e.GrossValue, e.NetValue));

            string json = JsonConvert.SerializeObject(entries);

            File.WriteAllText("input.json", json);
        }

        static List<Entry> GetEntries(string text, EntryType entryType)
        {
            List<Entry> entries = new List<Entry>();
            using (var reader = new StringReader(text))
            {
                string line;
                int counter = 0;
                while ((line = reader.ReadLine()) != null)
                    entries.Add(GetEntry(line, ++counter, entryType));
            }
            return entries;
        }

        static System.Globalization.CultureInfo culture = new System.Globalization.CultureInfo("th-Th");
        static Entry GetEntry(string text, int entryNo, EntryType entryType)
        {
            string[] split = text.Split('\t');
            DateTime date = DateTime.ParseExact(split[0], "M/d/yy H:mm", culture);
            int quantity = int.Parse(split[1].Substring(0, split[1].Length - 2));
            decimal value = decimal.Parse(split[3]);

            return new Entry(entryNo, date, entryType, quantity, value, value);
        }
    }
}
